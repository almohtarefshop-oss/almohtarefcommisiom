<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>إدارة العملاء والخدمات</title>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha512-xh6O/CkQoPOWDdYTDqeRdPCVd1SpvCA9XXcUnZS2FmJNp1coAFzvtCN9BmamE+4aHK8yyUHUSCcJHgXloTyT2A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;600;700&family=Segoe+UI&display=swap" rel="stylesheet">
    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- SheetJS -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
    
    <style>
        /* --- Base Styles and Theme Variables --- */
        :root {
            /* Light Theme Colors */
            --primary-light: #4361ee; --secondary-light: #3f37c9; --accent-light: #4895ef; --light-light: #f8f9fa; --dark-light: #212529; --bg-light: #eef1f5; --card-bg-light: #ffffff; --text-color-light: #333; --text-muted-light: #6c757d; --border-color-light: #dee2e6; --input-bg-light: #f8f9fa; --input-border-light: #ced4da; --hover-bg-light: #f0f0f0; --shadow-color-light: rgba(0, 0, 0, 0.08);
            /* Dark Theme Colors */
            --primary-dark: #5a79ff; --secondary-dark: #6f6af0; --accent-dark: #6bb4ff; --light-dark: #3a3a50; --dark-dark: #e0e0e0; --bg-dark: #161625; --card-bg-dark: #1e1e2f; --text-color-dark: #e0e0e0; --text-muted-dark: #a0a0b0; --border-color-dark: #44445a; --input-bg-dark: #2a2a3f; --input-border-dark: #55556a; --hover-bg-dark: #2f2f45; --shadow-color-dark: rgba(0, 0, 0, 0.2);
            /* Active Theme Variables */
            --primary: var(--primary-light); --secondary: var(--secondary-light); --accent: var(--accent-light); --light: var(--light-light); --dark: var(--dark-light); --bg-color: var(--bg-light); --card-bg: var(--card-bg-light); --text-color: var(--text-color-light); --text-muted: var(--text-muted-light); --border-color: var(--border-color-light); --input-bg: var(--input-bg-light); --input-border: var(--input-border-light); --hover-bg: var(--hover-bg-light); --shadow-color: var(--shadow-color-light);
            --heading-color: #1a73e8; --heading-color-dark: #8ab4f8; --link-color: var(--primary);
            /* Shared/Specific Colors */
            --success: #4cc9f0; --warning: #f72585; --info: #0056b3;
            --danger-bg: #f8d7da; --danger-text: #721c24; --danger-border: #f5c6cb;
            --danger-bg-dark: #5a2a2f; --danger-text-dark: #f5c6cb; --danger-border-dark: #a71b2a;
            /* Permanent customer highlight colors */
            --permanent-customer-border: #e4a11b;
            --permanent-customer-icon: #e4a11b;
            --permanent-customer-border-dark: #e4a11b;
            --permanent-customer-icon-dark: #e4a11b;
            /* VIP customer colors */
            --vip-customer-icon: #e4a11b;
            --vip-customer-icon-dark: #e4a11b;
            /* Font & Spacing */
            --base-font-size: 18px; --heading-font-size: 2rem; --subheading-font-size: 1.4rem; --button-font-size: 1rem; --base-line-height: 1.8;
             /* RGB Helper for Shadows */
            --rgb-accent: 72, 149, 239;
        }
        .dark-theme {
            --primary: var(--primary-dark); --secondary: var(--secondary-dark); --accent: var(--accent-dark); --light: var(--light-dark); --dark: var(--dark-dark); --bg-color: var(--bg-dark); --card-bg: var(--card-bg-dark); --text-color: var(--text-color-dark); --text-muted: var(--text-muted-dark); --border-color: var(--border-color-dark); --input-bg: var(--input-bg-dark); --input-border: var(--input-border-dark); --hover-bg: var(--hover-bg-dark); --shadow-color: var(--shadow-color-dark); --heading-color: var(--heading-color-dark); --link-color: var(--accent-dark);
            --danger-bg: var(--danger-bg-dark); --danger-text: var(--danger-text-dark); --danger-border: var(--danger-border-dark);
            --permanent-customer-border: var(--permanent-customer-border-dark);
            --permanent-customer-icon: var(--permanent-customer-icon-dark);
            --vip-customer-icon: var(--vip-customer-icon-dark);
            --rgb-accent: 107, 180, 255;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Tajawal', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; direction: rtl; background-color: var(--bg-color); color: var(--text-color); line-height: var(--base-line-height); padding: 0; font-size: var(--base-font-size); transition: background-color 0.3s ease, color 0.3s ease; font-weight: 400;
        }
        .app-container { max-width: 1200px; margin: 25px auto; background-color: var(--card-bg); border-radius: 14px; box-shadow: 0 5px 25px var(--shadow-color); overflow: hidden; position: relative; padding-bottom: 10px; transition: background-color 0.3s ease, box-shadow 0.3s ease; }
        /* Header & Tabs */
        .app-header { display: flex; justify-content: space-between; align-items: stretch; background-color: var(--light); border-bottom: 1px solid var(--border-color); padding: 5px 15px 0 15px; transition: background-color 0.3s ease, border-color 0.3s ease; position: sticky; top: 0; z-index: 990; }
        .tab-navigation { display: flex; flex-wrap: wrap; flex-grow: 1; }
        .tab-button { padding: 14px 20px; font-family: 'Tajawal', sans-serif; font-size: 1.0rem; font-weight: 600; cursor: pointer; border: none; background-color: transparent; color: var(--text-muted); border-bottom: 3px solid transparent; transition: all 0.3s ease; margin-left: 3px; position: relative; top: 1px; white-space: nowrap; }
        .tab-button:hover { color: var(--primary); }
        .tab-button.active { color: var(--primary); border-bottom-color: var(--primary); }
        /* Theme Toggle Button */
         .theme-toggle-button { background: none; border: none; color: var(--text-muted); font-size: 1.3rem; cursor: pointer; padding: 10px 15px; margin-left: 10px; border-radius: 5px; transition: color 0.3s ease, background-color 0.2s ease; align-self: center; line-height: 1; position: relative; top: -2px; }
         .theme-toggle-button:hover { color: var(--primary); background-color: var(--hover-bg); }
         .theme-toggle-button .fa-moon { display: inline; } .theme-toggle-button .fa-sun { display: none; }
         .dark-theme .theme-toggle-button .fa-moon { display: none; } .dark-theme .theme-toggle-button .fa-sun { display: inline; }
        /* Tab Content */
        .tab-content { display: none; padding: 25px; animation: fadeInContent 0.4s ease-in-out; }
        .tab-content.active { display: block; }
        @keyframes fadeInContent { from { opacity: 0; } to { opacity: 1; } }
        /* Dynamic Tab Specific Styling */
        .dynamic-html-content iframe { width: 100%; height: 70vh; border: 1px solid var(--border-color); border-radius: 6px; background-color: white; }
        .dark-theme .dynamic-html-content iframe { border-color: var(--border-color-dark); }
        .close-dynamic-tab-btn { background: none; border: none; color: var(--danger-text); font-size: 0.8em; cursor: pointer; padding: 0 4px; margin-right: 5px; opacity: 0.7; transition: opacity 0.2s ease; vertical-align: middle; line-height: 1; }
        .close-dynamic-tab-btn:hover { opacity: 1; }
        [dir="rtl"] .close-dynamic-tab-btn { margin-right: 0; margin-left: 5px; }

        /* General Heading Icons */
        h1 > i.fa-fw, h2 > i.fa-fw, h3 > i.fa-fw { margin-left: 10px; font-size: 0.9em; color: inherit; opacity: 0.8; }
        [dir="rtl"] h1 > i.fa-fw, [dir="rtl"] h2 > i.fa-fw, [dir="rtl"] h3 > i.fa-fw { margin-left: 0; margin-right: 10px; }

        /* --- Shared Styles for Tabs --- */
        .tab-content > h1 { color: var(--info); text-align: center; margin-bottom: 30px; font-size: var(--heading-font-size); border-bottom: 1px solid var(--border-color); padding-bottom: 20px; font-weight: 700; }
        .tab-content h2 { color: var(--heading-color); margin-top: 35px; margin-bottom: 15px; border-bottom: 1px solid var(--border-color); padding-bottom: 15px; font-size: var(--subheading-font-size); text-align: center; font-weight: 600; }
        .tab-content h2.no-top-border { margin-top: 0; padding-top: 0; border-top: none; }
        .tab-content hr.separator { border: 0; height: 1px; background: var(--border-color); margin: 40px 0; }
        .search-container { margin-bottom: 30px; text-align: center; position: relative; }
        .search-input { padding: 12px 15px 12px 45px; width: 70%; max-width: 500px; border: 1px solid var(--input-border); background-color: var(--input-bg); color: var(--text-color); border-radius: 25px; font-size: 1rem; transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out; font-family: 'Tajawal', sans-serif; }
        .search-input::placeholder { font-family: 'Tajawal', sans-serif; color: var(--text-muted); }
        .search-input:focus { border-color: var(--accent); outline: 0; box-shadow: 0 0 0 0.2rem rgba(var(--rgb-accent), 0.25); }
        .search-icon { position: absolute; right: 16%; top: 50%; transform: translateY(-50%); color: var(--text-muted); pointer-events: none; }
        [dir="rtl"] .search-icon { right: auto; left: 16%; }
        
        /* Customer List Section */
        .customer-list-section { border: 1px solid var(--border-color); border-radius: 8px; margin-bottom: 30px; overflow: hidden; background-color: var(--card-bg); transition: background-color 0.3s ease, border-color 0.3s ease; }
        .customer-list-section .section-header { display: flex; align-items: center; padding: 15px 20px; background-color: var(--light); margin: 0; font-size: 1.1rem; color: var(--text-color); border: none; padding: 0; text-align: right; font-weight: 600; gap: 8px; }
        .customer-list-section .section-header i { font-size: 1em; opacity: 0.9; }
        .customer-list-content { padding: 25px; max-height: none !important; overflow-y: auto; }

        /* Form Group Styling */
        .form-group { margin-bottom: 18px; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: 600; color: var(--text-color); font-size: 0.95em; }
        .form-group input[type="text"], .form-group input[type="tel"], .form-group input[type="number"], .form-group input[type="url"], .form-group textarea, .form-group input[type="checkbox"] { width: 100%; padding: 10px 12px; border: 1px solid var(--input-border); background-color: var(--input-bg); color: var(--text-color); border-radius: 4px; font-size: 1rem; font-family: 'Tajawal', sans-serif; font-weight: 400; }
        .form-group textarea { min-height: 80px; resize: vertical; line-height: 1.6; }
        .form-group input:focus, .form-group textarea:focus { border-color: var(--accent); outline: none; box-shadow: 0 0 0 0.1rem rgba(var(--rgb-accent), 0.2); }
        .form-group.checkbox-group { display: flex; align-items: center; gap: 10px; }
        .form-group.checkbox-group label { margin-bottom: 0; cursor: pointer; }
        .form-group.checkbox-group input[type="checkbox"] { width: auto; height: 1.2em; width: 1.2em; cursor: pointer; accent-color: var(--primary); margin-top: 2px; }
        
        /* Buttons Base Styling */
        .btn, button.modal-button, button.calculate-btn { display: inline-flex; align-items: center; justify-content: center; padding: 10px 20px; font-size: var(--button-font-size); font-family: 'Tajawal', sans-serif; font-weight: 600; border: none; border-radius: 5px; cursor: pointer; transition: all 0.2s ease; margin-left: 10px; margin-top: 5px; vertical-align: middle; text-decoration: none; }
        .btn i, button.modal-button i, button.calculate-btn i { margin-left: 8px; } [dir="rtl"] .btn i, [dir="rtl"] button.modal-button i, [dir="rtl"] button.calculate-btn i { margin-left: 0; margin-right: 8px; }
        .btn:disabled, button:disabled { opacity: 0.6; cursor: not-allowed; }
        /* Specific Button Colors/Styles */
        .btn-primary { background-color: var(--primary); color: white; } .btn-primary:hover:not(:disabled) { background-color: var(--secondary); transform: translateY(-1px); }
        .btn-secondary { background-color: #6c757d; color: white; } .btn-secondary:hover:not(:disabled) { background-color: #5a6268; transform: translateY(-1px); }
        .btn-success { background-color: #28a745; color: white; } .btn-success:hover:not(:disabled) { background-color: #218838; transform: translateY(-1px); }
        .btn-danger { background-color: #dc3545; color: white; } .btn-danger:hover:not(:disabled) { background-color: #c82333; transform: translateY(-1px); }
        .btn-warning { background-color: #ffc107; color: #1f2937; } .btn-warning:hover:not(:disabled) { background-color: #e0a800; transform: translateY(-1px); }
        .dark-theme .btn-warning { background-color: #e0a800; color: #111; } .dark-theme .btn-warning:hover:not(:disabled) { background-color: #c89400; }
        .btn-info { background-color: #17a2b8; color: white; } .btn-info:hover:not(:disabled) { background-color: #138496; transform: translateY(-1px); }
        .dark-theme .btn-info { background-color: #2aa1b5; } .dark-theme .btn-info:hover:not(:disabled) { background-color: #3bc8de; }
        
        /* Backup/IO Section */
        .io-section { margin-top: 40px; padding: 20px; border: 1px dashed var(--border-color); border-radius: 8px; background-color: var(--light); text-align: center; transition: background-color 0.3s ease, border-color 0.3s ease; }
        .io-section h2 { margin-top: 0; margin-bottom: 15px; color: var(--text-muted); border: none; padding: 0; font-weight: 600; display: flex; align-items: center; justify-content: center; gap: 8px; font-size: 1.3em; }
        .io-section h2 i { font-size: 1em; }
        .io-section p { margin-bottom: 15px; color: var(--text-muted); font-size: 0.95em; }
        .io-section button { margin: 5px; }
        .io-section #importStatus { margin-top: 15px; font-weight: bold; min-height: 1.2em; }
        .io-section .status-success { color: var(--success); } .dark-theme .io-section .status-success { color: #66d9ef; }
        .io-section .status-error { color: var(--danger-color); } .dark-theme .io-section .status-error { color: #ff78a1; }
        .io-section .status-warning { color: orange; } .dark-theme .io-section .status-warning { color: #ffd700; }

        /* --- Customer List Tab Specific Styles --- */
        .customer-list-controls { display: flex; justify-content: flex-end; padding: 0 0 10px 0; margin-top: 0; }
        #layoutToggleButton { font-size: 0.9rem; padding: 5px 10px; margin: 0; background-color: var(--light); border: 1px solid var(--border-color); color: var(--text-muted); }
        #layoutToggleButton:hover { background-color: var(--hover-bg); color: var(--primary); }
        #layoutToggleButton i { margin-right: 5px; margin-left: 0; }
        [dir="rtl"] #layoutToggleButton i { margin-left: 5px; margin-right: 0; }
        .customer-grid-container.grid-layout { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 20px; margin-top: 0; }
        .customer-grid-container.list-layout { display: flex; flex-direction: column; gap: 15px; margin-top: 0; }
        .customer-grid-container.list-layout .customer-card { display: flex; padding: 15px; flex-direction: row; align-items: flex-start; margin-bottom: 15px; border: 1px solid var(--border-color); border-radius: 8px; background-color: var(--card-bg); }
        [dir="rtl"] .customer-grid-container.list-layout .customer-card { flex-direction: row-reverse; }
        .customer-grid-container.list-layout .card-options-container { position: static; order: 3; margin-right: auto; margin-left: 10px; align-self: center; }
        [dir="rtl"] .customer-grid-container.list-layout .card-options-container { margin-right: 10px; margin-left: auto; }
        .customer-grid-container.list-layout .permanent-customer-badge { position: static; order: 1; margin-left: 10px; align-self: center; font-size: 1.4rem; }
        [dir="rtl"] .customer-grid-container.list-layout .permanent-customer-badge { margin-left: 0; margin-right: 10px; }
        .customer-grid-container.list-layout .customer-card > div:last-child { display: flex; flex-wrap: wrap; flex-grow: 1; order: 2; gap: 5px 15px; }
        .customer-grid-container.list-layout .customer-card p { margin-bottom: 5px; flex-basis: 45%; min-width: 200px; flex-grow: 1; }
        .customer-grid-container.list-layout .customer-card p.notes-paragraph { flex-basis: 100%; }
        .customer-grid-container.list-layout .customer-card p .value-text { white-space: normal; }
        .customer-card { background-color: var(--card-bg); border: 1px solid var(--border-color); border-radius: 8px; padding: 20px; padding-top: 45px; box-shadow: 0 1px 4px var(--shadow-color); transition: box-shadow 0.3s ease, background-color 0.3s ease, border-color 0.3s ease; position: relative; border-left: 4px solid transparent; }
        [dir="rtl"] .customer-card { border-left: none; border-right: 4px solid transparent; }
        .customer-card:hover { box-shadow: 0 4px 12px var(--shadow-color); }
        .customer-card.permanent-customer { border-left-color: var(--permanent-customer-border); }
        [dir="rtl"] .customer-card.permanent-customer { border-right-color: var(--permanent-customer-border); }
        .customer-card.vip-customer { border-left-color: var(--vip-customer-icon); }
        [dir="rtl"] .customer-card.vip-customer { border-right-color: var(--vip-customer-icon); }
        .permanent-customer-badge { position: absolute; top: 12px; right: 45px; font-size: 1.1rem; color: var(--permanent-customer-icon); opacity: 0.8; }
        [dir="rtl"] .permanent-customer-badge { right: auto; left: 45px; }
        .vip-customer-badge { position: absolute; top: 12px; left: 45px; font-size: 1.1rem; color: var(--vip-customer-icon); opacity: 0.8; }
        [dir="rtl"] .vip-customer-badge { left: auto; right: 45px; }
        .quick-toggle-buttons { position: absolute; top: 10px; right: 45px; display: flex; gap: 5px; }
        [dir="rtl"] .quick-toggle-buttons { right: auto; left: 45px; }
        .toggle-permanent-btn, .toggle-vip-btn { background: none; border: none; color: var(--text-muted); cursor: pointer; font-size: 1rem; opacity: 0.7; transition: all 0.2s ease; }
        .toggle-permanent-btn:hover, .toggle-vip-btn:hover { opacity: 1; }
        .toggle-permanent-btn.active { color: var(--permanent-customer-icon); opacity: 1; }
        .toggle-vip-btn.active { color: var(--vip-customer-icon); opacity: 1; }
        .customer-card p { margin-bottom: 12px; color: var(--text-color); line-height: var(--base-line-height); display: flex; align-items: baseline; gap: 8px; flex-wrap: nowrap; }
        .customer-card p.notes-paragraph { flex-wrap: wrap; align-items: flex-start; }
        .customer-card p strong { color: var(--text-color); margin-left: 5px; font-weight: 700; flex-shrink: 0; font-size: 0.95em; }
        .customer-card p.notes-paragraph strong { display: block; width: 100%; margin-bottom: 5px; margin-left: 0; }
        .customer-card p .value-text { flex-grow: 1; flex-shrink: 1; text-align: right; font-weight: 400; color: var(--text-color); font-size: 1.05em; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; min-width: 0; }
        .customer-card p.notes-paragraph .value-text { font-weight: 700; font-size: 0.95em; color: var(--text-muted); background-color: var(--input-bg); padding: 8px; border-radius: 4px; border: 1px solid var(--border-color); width: 100%; margin-top: 0; white-space: pre-wrap; overflow: visible; text-overflow: clip; line-height: 1.6; }
        .customer-card p.layout-stacked { flex-wrap: wrap; align-items: flex-start; }
        .customer-card p.layout-stacked strong { width: 100%; margin-bottom: 4px; }
        .customer-card p.layout-stacked .value-copy-wrapper { display: flex; align-items: baseline; width: 100%; gap: 5px; }
        .customer-card p.layout-stacked .value-text { white-space: normal; overflow: visible; text-overflow: clip; word-break: break-all; flex-basis: calc(100% - 40px); margin-right: 0; min-width: auto; }
        .customer-card p.layout-stacked .copy-btn { align-self: baseline; flex-shrink: 0; padding-top: 1px; }
        .card-options-container { position: absolute; top: 10px; left: 10px; z-index: 10; }
        .card-options-btn { background: none; border: none; color: var(--text-muted); font-size: 1.1rem; padding: 5px 8px; cursor: pointer; border-radius: 50%; transition: background-color 0.2s ease, color 0.2s ease; line-height: 1; margin: 0; }
        .card-options-btn:hover, .card-options-btn:focus { background-color: var(--hover-bg); color: var(--primary); outline: none; }
        .card-options-menu { display: none; position: absolute; top: 100%; left: 0; background-color: var(--card-bg); border: 1px solid var(--border-color); border-radius: 6px; box-shadow: 0 2px 10px var(--shadow-color); min-width: 120px; overflow: hidden; opacity: 0; transform: translateY(5px); transition: opacity 0.2s ease, transform 0.2s ease, background-color 0.3s ease, border-color 0.3s ease; padding: 5px 0; z-index: 11; }
        .card-options-menu.active { display: block; opacity: 1; transform: translateY(0); }
        .card-options-menu ul { list-style: none; padding: 0; margin: 0; }
        .card-options-menu li a { display: block; padding: 8px 15px; color: var(--text-color); text-decoration: none; font-size: 0.95rem; transition: background-color 0.2s ease, color 0.2s ease; white-space: nowrap; cursor: pointer; }
        .card-options-menu li a:hover { background-color: var(--hover-bg); color: var(--primary); }
        .card-options-menu li a i { margin-left: 8px; color: var(--text-muted); width: 1.2em; text-align: center; transition: color 0.2s ease; }
        .card-options-menu li a:hover i { color: var(--primary); }
        [dir="rtl"] .card-options-container { left: auto; right: 10px; }
        [dir="rtl"] .card-options-menu { left: auto; right: 0; }
        [dir="rtl"] .card-options-menu li a i { margin-left: 0; margin-right: 8px; }
        .copy-btn { background: transparent; border: none; color: var(--accent); padding: 0 3px; font-size: 1em; cursor: pointer; margin-right: 3px; margin-left: 0; opacity: 0.7; transition: opacity 0.2s ease, color 0.2s ease; flex-shrink: 0; line-height: inherit; align-self: center; }
        .copy-btn:hover { opacity: 1; color: var(--primary); }
        .copy-btn .fa-check { color: #28a745; font-weight: bold; }

        /* Collapsible Section Styles */
        .collapsible-section { border: 1px solid var(--border-color); border-radius: 8px; margin-bottom: 20px; overflow: hidden; transition: all 0.3s ease; }
        .collapsible-section.open { background-color: var(--card-bg); }
        .collapsible-header { display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; background-color: var(--light); cursor: pointer; user-select: none; transition: background-color 0.3s ease; }
        .collapsible-header:hover { background-color: var(--hover-bg); }
        .collapsible-header h2 { margin: 0; font-size: 1.1rem; color: var(--text-color); display: flex; align-items: center; gap: 8px; }
        .collapsible-toggle-icon { transition: transform 0.3s ease; }
        .collapsible-section.open .collapsible-toggle-icon { transform: rotate(180deg); }
        .collapsible-content { max-height: 0; overflow: hidden; transition: max-height 0.3s ease, padding 0.3s ease; }
        .collapsible-section.open .collapsible-content { max-height: 1000px; padding: 20px; }

        /* --- Commission Calculator Tab Specific Styles --- */
        #commissionCalculatorContent .calculator-container { width: 100%; max-width: 550px; background: var(--card-bg); border-radius: 20px; box-shadow: 0 10px 25px var(--shadow-color); overflow: hidden; margin: 10px auto 30px auto; transition: background-color 0.3s ease, box-shadow 0.3s ease; }
        #commissionCalculatorContent .calculator-header { background: linear-gradient(to right, var(--primary), var(--secondary)); color: white; padding: 25px; text-align: center; position: relative; }
        #commissionCalculatorContent .calculator-header h1 { font-size: 1.9rem; margin-bottom: 15px; font-weight: 700; display: flex; align-items: center; justify-content: center; gap: 10px;} #commissionCalculatorContent .calculator-header h1 i { font-size: 0.8em;} #commissionCalculatorContent .calculator-header p { opacity: 0.9; font-size: 1rem; font-weight: 400; } #commissionCalculatorContent .calculator-header::after { content: ''; position: absolute; bottom: 0; left: 0; width: 100%; height: 10px; background: radial-gradient(circle at 50% 100%, transparent 10px, var(--card-bg) 10px); background-size: 20px 20px; background-repeat: repeat-x; transition: background 0.3s ease; } #commissionCalculatorContent .calculator-body { padding: 25px; } #commissionCalculatorContent .input-group { margin-bottom: 20px; } #commissionCalculatorContent .input-group label { display: block; margin-bottom: 8px; color: var(--text-color); font-weight: 600; font-size: 1rem; } #commissionCalculatorContent .input-field { position: relative; } #commissionCalculatorContent .input-field input { width: 100%; padding: 15px 45px 15px 20px; border: 2px solid var(--input-border); background-color: var(--input-bg); color: var(--text-color); border-radius: 12px; font-size: 1rem; transition: all 0.3s; text-align: left; direction: ltr; } #commissionCalculatorContent .input-field input::placeholder { text-align: right; direction: rtl; opacity: 0.6; color: var(--text-muted); } #commissionCalculatorContent .input-field input:focus { border-color: var(--accent); box-shadow: 0 0 0 3px rgba(var(--rgb-accent), 0.2); outline: none; background-color: var(--card-bg); } #commissionCalculatorContent .input-field i { position: absolute; right: 15px; top: 50%; transform: translateY(-50%); color: var(--primary); font-size: 1.1rem; } #commissionCalculatorContent .calculate-btn { width: 100%; padding: 15px; background: linear-gradient(to right, var(--primary), var(--secondary)); color: white; border-radius: 12px; font-weight: 700; margin-top: 10px; box-shadow: 0 4px 15px rgba(var(--rgb-accent), 0.3); } #commissionCalculatorContent .calculate-btn:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(var(--rgb-accent), 0.4); } #commissionCalculatorContent .calculate-btn:active { transform: translateY(0); } #commissionCalculatorContent .results-container { margin-top: 30px; background: var(--light); border-radius: 15px; border: 1px solid var(--border-color); overflow: hidden; animation: slideUp 0.4s ease-out; transition: background-color 0.3s ease, border-color 0.3s ease; } @keyframes slideUp { from { transform: translateY(10px); opacity: 0; } to { transform: translateY(0); opacity: 1; } } #commissionCalculatorContent .result-item { display: flex; justify-content: space-between; align-items: center; padding: 12px 20px; border-bottom: 1px solid var(--border-color); flex-wrap: transition: border-color 0.3s ease; } #commissionCalculatorContent .result-item:not(.total-amount-row):not(.total-commission-row):last-of-type { border-bottom: none; } #commissionCalculatorContent .result-label { color: var(--text-muted); font-weight: 400; margin-left: 10px; flex-shrink: 0; } #commissionCalculatorContent .result-value { font-weight: 600; direction: ltr; text-align: left; color: var(--secondary); word-break: break-all; } #commissionCalculatorContent .total-amount-row { background-color: #e7f5ff; border-bottom: 2px solid var(--info); margin: -1px -1px 15px -1px; padding: 15px 20px; border-top-left-radius: 15px; border-top-right-radius: 15px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; position: relative; } .dark-theme #commissionCalculatorContent .total-amount-row { background-color: #2a3a4a; border-bottom-color: var(--accent-dark); } #commissionCalculatorContent .total-amount-row .result-label, #commissionCalculatorContent .total-amount-row .result-value { color: var(--info); font-size: 1.1rem; margin-left: 10px; flex-shrink: 0; } .dark-theme #commissionCalculatorContent .total-amount-row .result-label, .dark-theme #commissionCalculatorContent .total-amount-row .result-value { color: var(--accent-dark); } #commissionCalculatorContent .total-amount-row .result-value { font-size: 1.3rem; color: var(--info); font-weight: 700; direction: ltr; text-align: left; } .dark-theme #commissionCalculatorContent .total-amount-row .result-value { color: var(--accent-dark); } #commissionCalculatorContent .total-commission-row { margin-top: 15px; padding-top: 15px; padding-left: 20px; padding-right: 20px; padding-bottom: 12px; border-top: 2px dashed var(--text-muted); border-bottom: none; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; transition: border-color 0.3s ease; } #commissionCalculatorContent .total-commission-row .result-label { font-size: 1.1rem; font-weight: 700; color: var(--text-color); } #commissionCalculatorContent .total-commission-row .result-value { font-size: 1.2rem; color: var(--warning); font-weight: 700; } .dark-theme #commissionCalculatorContent .total-commission-row .result-value { color: #ff9eb8; } #commissionCalculatorContent .rules-container { margin-top: 30px; background: var(--card-bg); border-radius: 15px; padding: 0px 20px; box-shadow: 0 5px 15px var(--shadow-color); border: 1px solid var(--border-color); transition: background-color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease; } #commissionCalculatorContent .rules-title { color: var(--primary); margin-bottom: 0; font-size: 1.2rem; font-weight: 600; display: flex; align-items: center; gap: 10px; padding: 15px 0; border-bottom: 1px solid var(--border-color); cursor: pointer; position: relative; padding-left: 30px; transition: border-color 0.3s ease; } #commissionCalculatorContent .rules-title:focus { outline: 2px solid var(--accent); outline-offset: 2px; border-radius: 4px; } #commissionCalculatorContent .rules-title i.fa-info-circle { font-size: 1.3rem; color: var(--primary); } #commissionCalculatorContent .rules-toggle-icon { position: absolute; left: 0px; top: 50%; transform: translateY(-50%); transition: transform 0.3s ease; color: var(--primary); font-size: 1rem; } [dir="rtl"] #commissionCalculatorContent .rules-title { padding-left: 0; padding-right: 30px; } [dir="rtl"] #commissionCalculatorContent .rules-toggle-icon { left: auto; right: 0px; } #commissionCalculatorContent .rules-content { max-height: 0; overflow: hidden; transition: max-height 0.4s ease-out, padding 0.4s ease-out, margin 0.4s ease-out; padding-top: 0; padding-bottom: 0; margin-top: 0; color: var(--text-color); } #commissionCalculatorContent .rules-container.open .rules-content { max-height: 1000px; padding-top: 15px; padding-bottom: 15px; margin-top: 0; } #commissionCalculatorContent .rules-container.open .rules-toggle-icon { transform: translateY(-50%) rotate(180deg); } #commissionCalculatorContent .rules-list { list-style: none; padding-right: 0; margin-bottom: 15px; } #commissionCalculatorContent .rules-list > li { padding: 10px 0; position: relative; padding-right: 25px; border-bottom: 1px dashed var(--border-color); transition: border-color 0.3s ease;} #commissionCalculatorContent .rules-list > li:last-child { border-bottom: none; } #commissionCalculatorContent .rules-list li::before { content: '•'; color: var(--accent); font-weight: bold; position: absolute; right: 0; top: 10px; font-size: 1.2rem; } #commissionCalculatorContent .rule-category { font-weight: 600; color: var(--secondary); display: block; margin-bottom: 8px; } #commissionCalculatorContent .sub-rules { list-style: none; margin-right: 10px; padding-right: 0; } #commissionCalculatorContent .sub-rules li { padding: 6px 0; position: relative; padding-right: 20px; font-size: 0.95rem; color: var(--text-muted); } #commissionCalculatorContent .sub-rules li::before { content: '←'; color: var(--accent); position: absolute; right: 0; top: 6px; font-size: 1rem; } #commissionCalculatorContent .example { background: var(--light); padding: 15px; border-radius: 10px; margin-top: 20px; font-size: 0.9rem; border-right: 4px solid var(--accent); line-height: 1.6; color: var(--text-color); transition: background-color 0.3s ease, border-color 0.3s ease; } [dir="rtl"] #commissionCalculatorContent .example { border-right: none; border-left: 4px solid var(--accent); } #commissionCalculatorContent .example strong { color: var(--secondary); display: block; margin-bottom: 8px; font-weight: 600; } #commissionCalculatorContent .example br { content: ""; display: block; margin-bottom: 4px; } #commissionCalculatorContent .visa-calculator .calculator-header { background: linear-gradient(to right, #2a9d8f, #264653); } #commissionCalculatorContent .visa-calculator .results-container .total-amount-row { background-color: #e9f5e9; border-bottom-color: #28a745; } .dark-theme #commissionCalculatorContent .visa-calculator .results-container .total-amount-row { background-color: #2f4d2f; border-bottom-color: #5dbd5d; } #commissionCalculatorContent .visa-calculator .results-container .total-amount-row .result-label, #commissionCalculatorContent .visa-calculator .results-container .total-amount-row .result-value { color: #28a745; } .dark-theme #commissionCalculatorContent .visa-calculator .results-container .total-amount-row .result-label, .dark-theme #commissionCalculatorContent .visa-calculator .results-container .total-amount-row .result-value { color: #81c784; } #commissionCalculatorContent .visa-calculator .results-container .total-amount-row .result-label, #commissionCalculatorContent .visa-calculator .results-container .total-amount-row .result-value { color: #28a745; } .dark-theme #commissionCalculatorContent .visa-calculator .results-container .total-amount-row .result-label, .dark-theme #commissionCalculatorContent .visa-calculator .results-container .total-amount-row .result-value { color: #81c784; } #commissionCalculatorContent #visaCalcStatus { min-height: 1.2em; margin-top: 15px; text-align: center; font-weight: 500; } #commissionCalculatorContent .status-error { color: red; } #commissionCalculatorContent .status-warning { color: orange; } .dark-theme #commissionCalculatorContent .status-error { color: #ff78a1; } .dark-theme #commissionCalculatorContent .status-warning { color: #ffd700; }

        /* --- Services Tab Specific Styles --- */
        #servicesContent .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; } #servicesContent .table-container { overflow-x: auto; margin-top: 20px; } #servicesContent #servicesTable { width: 100%; border-collapse: collapse; font-size: 0.95rem; background-color: var(--card-bg); border-radius: var(--border-radius, 8px); overflow: hidden; box-shadow: 0 1px 4px var(--shadow-color); transition: background-color 0.3s ease, box-shadow 0.3s ease; } #servicesContent #servicesTable th, #servicesContent #servicesTable td { border: 1px solid var(--border-color); padding: 10px 12px; text-align: right; vertical-align: middle; font-weight: 500; transition: border-color 0.3s ease; } #servicesContent #servicesTable th { background-color: var(--light); color: var(--text-color); font-weight: 700; white-space: nowrap; position: sticky; top: 0; z-index: 1; } #servicesContent #servicesTable tbody tr:nth-child(odd) { background-color: rgba(0,0,0,0.02); } .dark-theme #servicesContent #servicesTable tbody tr:nth-child(odd) { background-color: rgba(255,255,255,0.03); } #servicesContent #servicesTable tbody tr:hover { background-color: var(--hover-bg); } #servicesContent #servicesTable td:last-child { text-align: center; white-space: nowrap; width: 100px; } #servicesContent .action-buttons { display: flex; gap: 8px; justify-content: center; } #servicesContent .edit-service-btn { /* Inherits .btn .btn-primary */ } #servicesContent .delete-service-btn { /* Inherits .btn .btn-danger */ } #servicesContent .link { color: var(--link-color); text-decoration: none; } #servicesContent .link:hover { text-decoration: underline; } #servicesContent .search-export-container { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px; margin-bottom: 0px; margin-top: 10px; } #servicesContent .search-box { flex-grow: 1; min-width: 250px; position: relative; } #servicesContent .search-box i { position: absolute; right: 15px; top: 50%; transform: translateY(-50%); color: var(--text-muted); pointer-events: none; } #servicesContent .search-input { padding-right: 40px; } [dir="rtl"] #servicesContent .search-box i { right: auto; left: 15px; } [dir="rtl"] #servicesContent .search-input { padding-right: 15px; padding-left: 40px; } #servicesContent .export-import-buttons { display: flex; gap: 10px; } #servicesContent .export-import-buttons button { margin: 0; } #servicesContent .empty-state { text-align: center; padding: 40px 20px; color: var(--text-muted); } #servicesContent .empty-state i { font-size: 3rem; margin-bottom: 20px; color: var(--border-color); } #servicesContent #serviceImportStatus { text-align: center; margin-top: 15px; font-weight: bold; min-height: 1.2em; } #addServiceSection { /* Inherits .collapsible-section */ } #serviceFormToggleHeader { /* Inherits .collapsible-header */ } #addServiceSection .collapsible-content { /* Inherits .collapsible-content */ }

        /* --- Modal Styles --- */
        .modal-overlay { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.6); align-items: center; justify-content: center; direction: rtl; } .modal-overlay.active { display: flex; } .modal-container { background-color: var(--card-bg); margin: auto; padding: 25px 30px; border: 1px solid var(--border-color); width: 90%; max-width: 450px; border-radius: 10px; box-shadow: 0 4px 15px var(--shadow-color); text-align: center; animation: zoomIn 0.3s ease-out; transition: background-color 0.3s ease, border-color 0.3s ease; } @keyframes zoomIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } } .modal-icon { font-size: 2.5rem; color: var(--warning); margin-bottom: 15px; } .modal-message { font-size: 1.1rem; color: var(--text-color); margin-bottom: 25px; line-height: 1.7; text-align: right; } .modal-message strong { color: var(--danger-text); } .modal-buttons { display: flex; justify-content: center; gap: 15px; } .modal-button { padding: 10px 25px; font-size: var(--button-font-size); font-weight: 600; min-width: 100px; } .modal-button.confirm { background-color: #28a745; color: white; } .modal-button.confirm:hover { background-color: #218838; } .modal-button.cancel { background-color: #6c757d; color: white; } .modal-button.cancel:hover { background-color: #5a6268; } .dark-theme .modal-button.confirm { background-color: #388e3c; } .dark-theme .modal-button.confirm:hover { background-color: #2e7d32; } .dark-theme .modal-button.cancel { background-color: #5a6268; } .dark-theme .modal-button.cancel:hover { background-color: #495057; }
        /* --- Toast Notification Styles --- */
        #toastContainer { position: fixed; bottom: 20px; left: 20px; z-index: 2000; display: flex; flex-direction: column; align-items: flex-start; gap: 10px; } [dir="rtl"] #toastContainer { left: auto; right: 20px; align-items: flex-end; } .toast { background-color: rgba(40, 40, 50, 0.9); color: #fff; padding: 12px 20px; border-radius: 6px; box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2); opacity: 0; transform: translateY(20px); transition: opacity 0.3s ease, transform 0.3s ease; font-size: 0.95rem; max-width: 350px; word-wrap: break-word; border-left: 4px solid #555; } [dir="rtl"] .toast { border-left: none; border-right: 4px solid #555; } .toast.show { opacity: 1; transform: translateY(0); } .toast.hide { opacity: 0; transform: translateY(20px); } .toast-success { background-color: rgba(40, 167, 69, 0.9); border-color: #1e7e34; } .toast-error { background-color: rgba(220, 53, 69, 0.9); border-color: #a71d2a; } .toast-info { background-color: rgba(23, 162, 184, 0.9); border-color: #117a8b; } .toast-warning { background-color: rgba(255, 193, 7, 0.9); border-color: #b38600; color: #333;}

        /* --- Floating Scroll Button --- */
        #scrollTopBottomButton { position: fixed; bottom: 25px; right: 25px; z-index: 999; background-color: var(--primary); color: white; border: none; border-radius: 50%; width: 50px; height: 50px; font-size: 1.4rem; cursor: pointer; box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2); opacity: 0; visibility: hidden; transition: opacity 0.3s ease, visibility 0.3s ease, background-color 0.3s ease, transform 0.3s ease; display: flex; align-items: center; justify-content: center; line-height: 1; transform: scale(0.8); } #scrollTopBottomButton.visible { opacity: 0.85; visibility: visible; transform: scale(1); } #scrollTopBottomButton:hover { opacity: 1; background-color: var(--secondary); } [dir="rtl"] #scrollTopBottomButton { right: auto; left: 25px; }

        /* --- Media Queries --- */
        @media (max-width: 768px) { .app-container { margin: 15px; border-radius: 8px; } .app-header { padding: 5px 10px 0 10px; } .tab-button { padding: 10px 15px; font-size: 0.95rem;} .theme-toggle-button { padding: 8px 10px; font-size: 1.2rem;} .tab-content { padding: 15px; } .search-input { width: 85%; } .io-section { padding: 15px; } .modal-container { width: 85%; padding: 20px; } .modal-message { font-size: 1rem; } .modal-button { padding: 8px 20px; font-size: 0.95rem; min-width: 80px; } #toastContainer { bottom: 10px; left: 10px; width: calc(100% - 20px);} [dir="rtl"] #toastContainer { left: auto; right: 10px; } .toast { max-width: none; font-size: 0.9rem; } #scrollTopBottomButton { width: 45px; height: 45px; font-size: 1.2rem; bottom: 15px; right: 15px; } [dir="rtl"] #scrollTopBottomButton { left: 15px; } .customer-grid-container.grid-layout { grid-template-columns: 1fr; } .customer-grid-container.list-layout .customer-card { flex-direction: column; } .customer-grid-container.list-layout .card-options-container { align-self: flex-end; margin: 5px 0 0 0;} .customer-grid-container.list-layout .permanent-customer-badge { align-self: flex-start; margin: 0 0 5px 10px; } [dir="rtl"] .customer-grid-container.list-layout .permanent-customer-badge { margin-right: 10px; margin-left: 0; } #commissionCalculatorContent .calculator-header h1 { font-size: 1.5rem; } #commissionCalculatorContent .calculator-body { padding: 15px; } #commissionCalculatorContent .results-container { padding: 15px; } #commissionCalculatorContent .rules-container { padding-right: 15px; padding-left: 15px; } #commissionCalculatorContent .rules-title { padding: 10px 0; } #commissionCalculatorContent .result-item { padding: 10px 15px; } #commissionCalculatorContent .result-label { margin-bottom: 4px; margin-left: 0; width: 100%; } #commissionCalculatorContent .result-value { text-align: left; width: 100%; } #commissionCalculatorContent .total-amount-row { margin-left: -15px; margin-right: -15px; margin-top: -1px; padding-left: 15px; padding-right: 15px; border-top-left-radius: 15px; border-top-right-radius: 15px; } #commissionCalculatorContent .total-amount-row .result-label, #commissionCalculatorContent .total-commission-row .result-label { font-size: 1rem; } #commissionCalculatorContent .total-amount-row .result-value { font-size: 1.2rem; } #commissionCalculatorContent .total-commission-row { padding-left: 15px; padding-right: 15px; } #commissionCalculatorContent .total-commission-row .result-value { font-size: 1.1rem; } #servicesContent .search-export-container { flex-direction: column; align-items: stretch; } #servicesContent .export-import-buttons { justify-content: flex-end; } #servicesContent #servicesTable th, #servicesContent #servicesTable td { padding: 8px; font-size: 0.9rem; } #servicesContent #servicesTable th { position: static; } #servicesContent .edit-service-btn, #servicesContent .delete-service-btn { display: inline-block; width: auto; margin-bottom: 0; margin: 2px; } #servicesContent .search-export-container { gap: 10px; } #servicesContent .export-import-buttons { width: 100%; justify-content: space-between; } #servicesContent .export-import-buttons button { width: calc(50% - 5px); } }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@18.3.1",
    "react/jsx-runtime": "https://esm.sh/react@18.3.1/jsx-runtime",
    "react-dom": "https://esm.sh/react-dom@18.3.1",
    "react-dom/client": "https://esm.sh/react-dom@18.3.1/client",
    "lucide-react": "https://esm.sh/lucide-react@0.263.1",
    "react-dom/": "https://esm.sh/react-dom@^19.2.4/",
    "react/": "https://esm.sh/react@^19.2.4/"
  }
}
</script>
<link rel="stylesheet" href="/index.css">
</head>
<body>
    <div id="root"></div>
<script type="module" src="/index.tsx"></script>
</body>
</html>